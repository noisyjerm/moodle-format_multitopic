{"version":3,"file":"courseindex.min.js","sources":["../../../src/courseformat/courseindex/courseindex.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Course index main component.\n *\n * @module     core_courseformat/local/courseindex/courseindex\n * @class     core_courseformat/local/courseindex/courseindex\n * @copyright  2021 Ferran Recio <ferran@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport BaseComponent from 'core_courseformat/local/courseindex/courseindex';\nimport {getCurrentCourseEditor} from 'core_courseformat/courseeditor';\n\nexport default class Component extends BaseComponent {\n\n    /**\n     * Static method to create a component instance form the mustache template.\n     *\n     * @param {element|string} target the DOM main element or its ID\n     * @param {object} selectors optional css selector overrides\n     * @return {Component}\n     */\n    static init(target, selectors) {\n        return new Component({\n            element: document.getElementById(target),\n            reactive: getCurrentCourseEditor(),\n            selectors,\n        });\n    }\n\n\n    /**\n     * Refresh the section list.\n     *\n     * @param {object} param\n     * @param {Object} param.element\n     */\n    _refreshCourseSectionlist({element}) {\n        // Updating course index tree.\n        // Prevent moving out of order\n        const sectionlist = element.firstsectionlist ?? [];\n        this._fixOrder(this.element, sectionlist, this.sections);\n    }\n\n    /**\n     * Fix/reorder the section or cms order.\n     *\n     * @param {Element} container the HTML element to reorder.\n     * @param {Array} neworder an array with the ids order\n     * @param {Array} allitems the list of html elements that can be placed in the container\n     */\n    _fixOrder(container, neworder, allitems) {\n\n        // Empty lists should not be visible.\n        if (!neworder.length) {\n            container.classList.add('hidden');\n            container.innerHTML = '';\n            return;\n        }\n\n        // Grant the list is visible (in case it was empty).\n        container.classList.remove('hidden');\n\n        // Move the elements in order at the beginning of the list.\n        neworder.forEach((itemid, index) => {\n            const item = allitems[itemid];\n            // Get the current element at that position.\n            const currentitem = container.children[index];\n            if (currentitem === undefined) {\n                container.append(item);\n                return;\n            }\n            if (currentitem !== item) {\n                container.insertBefore(item, currentitem);\n            }\n        });\n        // Remove the remaining elements.\n        while (container.children.length > neworder.length) {\n            container.removeChild(container.lastChild);\n        }\n    }\n\n\n}\n"],"names":["Component","BaseComponent","target","selectors","element","document","getElementById","reactive","_refreshCourseSectionlist","sectionlist","firstsectionlist","_fixOrder","this","sections","container","neworder","allitems","length","classList","add","innerHTML","remove","forEach","itemid","index","item","currentitem","children","undefined","insertBefore","append","removeChild","lastChild"],"mappings":";;;;;;;;6JA2BqBA,kBAAkBC,iCASvBC,OAAQC,kBACT,IAAIH,UAAU,CACjBI,QAASC,SAASC,eAAeJ,QACjCK,UAAU,0CACVJ,UAAAA,YAWRK,8DAA0BJ,QAACA,oBAGjBK,0CAAcL,QAAQM,wEAAoB,QAC3CC,UAAUC,KAAKR,QAASK,YAAaG,KAAKC,UAUnDF,UAAUG,UAAWC,SAAUC,cAGtBD,SAASE,cACVH,UAAUI,UAAUC,IAAI,eACxBL,UAAUM,UAAY,QAK1BN,UAAUI,UAAUG,OAAO,UAG3BN,SAASO,SAAQ,CAACC,OAAQC,eAChBC,KAAOT,SAASO,QAEhBG,YAAcZ,UAAUa,SAASH,YACnBI,IAAhBF,YAIAA,cAAgBD,MAChBX,UAAUe,aAAaJ,KAAMC,aAJ7BZ,UAAUgB,OAAOL,SAQlBX,UAAUa,SAASV,OAASF,SAASE,QACxCH,UAAUiB,YAAYjB,UAAUkB"}